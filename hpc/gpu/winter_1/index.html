<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Winter HPC Setup 2021: Part 1"><meta name=author content="Samir B. Amin"><link href=https://code.sbamin.com/hpc/gpu/winter_1/ rel=canonical><link rel=icon href=/assets/images/fixed/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.1.5"><title>Setting up GPU env - Part 1 - Programming 101</title><link rel=stylesheet href=../../../assets/stylesheets/main.ee0f47ba.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.e6a45f82.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CFira+Code&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Code"}</style><link rel=stylesheet href=../../../assets/css/extra.css><script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><!-- Determine analytics provider (deprecated, removed in v8) --><!-- Determine analytics provider --><!-- Set up analytics provider --><!-- Determine analytics property (deprecated, removed in v8) --><!-- Determine analytics property --><!-- Google Analytics 4 (G-XXXXXXXXXX) --><script>
    window.ga = window.ga || function() {
      (ga.q = ga.q || []).push(arguments)
    }
    ga.l = +new Date()

    /* Set up integration and send page view */
    ga("create", "UA-307297-1", "auto")
    ga("set", "anonymizeIp", true)
    ga("send", "pageview")

    /* Register virtual event handlers */
    document.addEventListener("DOMContentLoaded", function() {
      if (document.forms.search) {
        var query = document.forms.search.query
        query.addEventListener("blur", function() {
          if (this.value) {
            var path = document.location.pathname;
            ga("send", "pageview", path + "?q=" + this.value)
          }
        })
      }

      /* Send page view on location change */
      if (typeof location$ !== "undefined")
        location$.subscribe(function(url) {
          ga("send", "pageview", url.pathname)
        })
    })
  </script><script async src=https://www.google-analytics.com/analytics.js></script><!--   <link rel="stylesheet" href="https://code.sbamin.com/../../../assets/stylesheets/main.c296cc61.min.css"> --><meta name=keywords content=winter,hpc,gpu,tensorflow,keras,pytorch,machine_learning,conda,jupyter><meta property=og:type content=website><meta property=og:title content="Part 1 · Programming 101"><meta property=og:description content="Winter HPC Setup 2021: Part 1"><meta content=https://code.sbamin.com/hpc/gpu/winter_1/ property=og:url><meta property=og:image content=https://code.sbamin.com/assets/images/fixed/sitelogo.png><meta property=og:image:type content=image/png><meta property=og:image:width content=256><meta property=og:image:height content=256><meta name=twitter:card content=summary><meta name=twitter:site content=@sbamin><meta name=twitter:creator content=@sbamin><meta name=twitter:title content="Part 1 · Programming 101"><meta name=twitter:description content="Winter HPC Setup 2021: Part 1"><meta name=twitter:image content=https://code.sbamin.com/assets/images/fixed/sitelogo.png><meta name=twitter:image:alt content="webpage banner or site logo"></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#login-to-gpu-hpc class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-component=outdated hidden> <aside class="md-banner md-banner--warning"> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="Programming 101" class="md-header__button md-logo" aria-label="Programming 101" data-md-component=logo> <img src=../../../assets/images/fixed/sitelogo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Programming 101 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Setting up GPU env - Part 1 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=teal data-md-color-accent=light-green aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/sbamin/code101/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M100.59 334.24c48.57 3.31 58.95 2.11 58.95 11.94 0 20-65.55 20.06-65.55 1.52.01-5.09 3.29-9.4 6.6-13.46zm27.95-116.64c-32.29 0-33.75 44.47-.75 44.47 32.51 0 31.71-44.47.75-44.47zM448 80v352a48 48 0 0 1-48 48H48a48 48 0 0 1-48-48V80a48 48 0 0 1 48-48h352a48 48 0 0 1 48 48zm-227 69.31c0 14.49 8.38 22.88 22.86 22.88 14.74 0 23.13-8.39 23.13-22.88S258.62 127 243.88 127c-14.48 0-22.88 7.84-22.88 22.31zM199.18 195h-49.55c-25-6.55-81.56-4.85-81.56 46.75 0 18.8 9.4 32 21.85 38.11C74.23 294.23 66.8 301 66.8 310.6c0 6.87 2.79 13.22 11.18 16.76-8.9 8.4-14 14.48-14 25.92C64 373.35 81.53 385 127.52 385c44.22 0 69.87-16.51 69.87-45.73 0-36.67-28.23-35.32-94.77-39.38l8.38-13.43c17 4.74 74.19 6.23 74.19-42.43 0-11.69-4.83-19.82-9.4-25.67l23.38-1.78zm84.34 109.84-13-1.78c-3.82-.51-4.07-1-4.07-5.09V192.52h-52.6l-2.79 20.57c15.75 5.55 17 4.86 17 10.17V298c0 5.62-.31 4.58-17 6.87v20.06h72.42zM384 315l-6.87-22.37c-40.93 15.37-37.85-12.41-37.85-16.73v-60.72h37.85v-25.41h-35.82c-2.87 0-2 2.52-2-38.63h-24.18c-2.79 27.7-11.68 38.88-34 41.42v22.62c20.47 0 19.82-.85 19.82 2.54v66.57c0 28.72 11.43 40.91 41.67 40.91 14.45 0 30.45-4.83 41.38-10.2z"/></svg> </div> <div class=md-source__repository> sbamin/code101 </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Getting started with HPC </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Programming 101" class="md-nav__button md-logo" aria-label="Programming 101" data-md-component=logo> <img src=../../../assets/images/fixed/sitelogo.png alt=logo> </a> Programming 101 </label> <div class=md-nav__source> <a href=https://github.com/sbamin/code101/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M100.59 334.24c48.57 3.31 58.95 2.11 58.95 11.94 0 20-65.55 20.06-65.55 1.52.01-5.09 3.29-9.4 6.6-13.46zm27.95-116.64c-32.29 0-33.75 44.47-.75 44.47 32.51 0 31.71-44.47.75-44.47zM448 80v352a48 48 0 0 1-48 48H48a48 48 0 0 1-48-48V80a48 48 0 0 1 48-48h352a48 48 0 0 1 48 48zm-227 69.31c0 14.49 8.38 22.88 22.86 22.88 14.74 0 23.13-8.39 23.13-22.88S258.62 127 243.88 127c-14.48 0-22.88 7.84-22.88 22.31zM199.18 195h-49.55c-25-6.55-81.56-4.85-81.56 46.75 0 18.8 9.4 32 21.85 38.11C74.23 294.23 66.8 301 66.8 310.6c0 6.87 2.79 13.22 11.18 16.76-8.9 8.4-14 14.48-14 25.92C64 373.35 81.53 385 127.52 385c44.22 0 69.87-16.51 69.87-45.73 0-36.67-28.23-35.32-94.77-39.38l8.38-13.43c17 4.74 74.19 6.23 74.19-42.43 0-11.69-4.83-19.82-9.4-25.67l23.38-1.78zm84.34 109.84-13-1.78c-3.82-.51-4.07-1-4.07-5.09V192.52h-52.6l-2.79 20.57c15.75 5.55 17 4.86 17 10.17V298c0 5.62-.31 4.58-17 6.87v20.06h72.42zM384 315l-6.87-22.37c-40.93 15.37-37.85-12.41-37.85-16.73v-60.72h37.85v-25.41h-35.82c-2.87 0-2 2.52-2-38.63h-24.18c-2.79 27.7-11.68 38.88-34 41.42v22.62c20.47 0 19.82-.85 19.82 2.54v66.57c0 28.72 11.43 40.91 41.67 40.91 14.45 0 30.45-4.83 41.38-10.2z"/></svg> </div> <div class=md-source__repository> sbamin/code101 </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../ >Getting started with HPC</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Getting started with HPC" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting started with HPC </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> CPU Computing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="CPU Computing" data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> CPU Computing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cpu/sumner_1/ class=md-nav__link> Part 1 </a> </li> <li class=md-nav__item> <a href=../../cpu/sumner_2/ class=md-nav__link> Part 2 </a> </li> <li class=md-nav__item> <a href=../../cpu/sumner_3/ class=md-nav__link> Part 3 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3 checked> <label class=md-nav__link for=__nav_2_3> GPU Computing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="GPU Computing" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> GPU Computing </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Part 1 <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Part 1 </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#login-to-gpu-hpc class=md-nav__link> Login to GPU HPC </a> </li> <li class=md-nav__item> <a href=#create-a-gpu-env-rey class=md-nav__link> Create a GPU env rey </a> </li> <li class=md-nav__item> <a href=#test-gpu-functionality class=md-nav__link> Test GPU functionality </a> </li> <li class=md-nav__item> <a href=#jupyter-kernels class=md-nav__link> Jupyter kernels </a> <nav class=md-nav aria-label="Jupyter kernels"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#renviron-setup class=md-nav__link> Renviron setup </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#optional-setup class=md-nav__link> Optional Setup </a> <nav class=md-nav aria-label="Optional Setup"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tensorboard class=md-nav__link> Tensorboard </a> </li> <li class=md-nav__item> <a href=#tensorrt class=md-nav__link> TensorRT </a> </li> <li class=md-nav__item> <a href=#image-classification class=md-nav__link> Image Classification </a> <nav class=md-nav aria-label="Image Classification"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cellprofiler class=md-nav__link> Cellprofiler </a> </li> <li class=md-nav__item> <a href=#cellpose class=md-nav__link> Cellpose </a> </li> <li class=md-nav__item> <a href=#stardist class=md-nav__link> Stardist </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#update-bash-startup class=md-nav__link> Update bash startup </a> </li> <li class=md-nav__item> <a href=#done class=md-nav__link> Done! </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#login-to-gpu-hpc class=md-nav__link> Login to GPU HPC </a> </li> <li class=md-nav__item> <a href=#create-a-gpu-env-rey class=md-nav__link> Create a GPU env rey </a> </li> <li class=md-nav__item> <a href=#test-gpu-functionality class=md-nav__link> Test GPU functionality </a> </li> <li class=md-nav__item> <a href=#jupyter-kernels class=md-nav__link> Jupyter kernels </a> <nav class=md-nav aria-label="Jupyter kernels"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#renviron-setup class=md-nav__link> Renviron setup </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#optional-setup class=md-nav__link> Optional Setup </a> <nav class=md-nav aria-label="Optional Setup"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tensorboard class=md-nav__link> Tensorboard </a> </li> <li class=md-nav__item> <a href=#tensorrt class=md-nav__link> TensorRT </a> </li> <li class=md-nav__item> <a href=#image-classification class=md-nav__link> Image Classification </a> <nav class=md-nav aria-label="Image Classification"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cellprofiler class=md-nav__link> Cellprofiler </a> </li> <li class=md-nav__item> <a href=#cellpose class=md-nav__link> Cellpose </a> </li> <li class=md-nav__item> <a href=#stardist class=md-nav__link> Stardist </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#update-bash-startup class=md-nav__link> Update bash startup </a> </li> <li class=md-nav__item> <a href=#done class=md-nav__link> Done! </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <div class="admonition warning"> <p class=admonition-title> 🚧 Work in Progress 🚧 </p> <p>Following page is work in progress. Feel free to contribute by clicking <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg></span> icon located next to the title of this page. If you land on a github 404 page, you may either not have logged into your github account or not have been added to a required github group of writers. For the latter, tweet <span class="twemoji twitter"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></span> <code>@sbamin</code> to be added into a valid group.</p> </div> <!-- Add copied contents from original content.html here --> <!-- https://raw.githubusercontent.com/squidfunk/mkdocs-material/master/src/partials/content.html --> <!-- Edit button --> <a href=https://github.com/sbamin/code101/edit/scratch/web/docs/hpc/gpu/winter_1.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <!--
  Hack: check whether the content contains a h1 headline. If it
  doesn't, the page title (or respectively site name) is used
  as the main headline.
--> <h1>Part 1</h1> <!-- Markdown content --> <p>Winter HPC at JAX is a GPU-based computing cluster and it is powered by <a href=https://www.nvidia.com/en-us/data-center/v100/ >NVIDIA&reg; V100 series</a> GPU cards. If you are working on GPU-based HPC or linux env, following page should guide you on setting up commonly used GPU libraries, e.g., <a href=https://www.tensorflow.org/ >Tensorflow 2</a>, <a href=https://keras.io/about/ >Keras</a>, and <a href=https://pytorch.org/ >PyTorch</a>. GPU setup involves several technical jargon related to hardware compliant libraries, e.g., CUDA toolkit if using NVIDIA marketed GPU cards. I will not go into details of each step here and instead link to installation guide for further details. Knowing such details should be useful while working with deep learning tools and debugging runtime errors.</p> <p>Before starting GPU setup, I expect that you have finished CPU setup, up until <a href=../../cpu/sumner_3/ >Part 3</a>, mainly installing <a href=../../cpu/sumner_2/#create-a-new-env><em>yoda</em> env</a> and <a href=../../cpu/sumner_3/#bash-startup>bash startup sequence</a>.</p> <h2 id=login-to-gpu-hpc>Login to GPU HPC<a class=headerlink href=#login-to-gpu-hpc title="Permanent link">&para;</a></h2> <p>First, let's move away from CPU HPC, aka Sumer HPC at JAX, and instead login to GPU HPC, i.e., Winter HPC at JAX. We have a common linux base operating system (OS), i.e., Cent OS 7 and a user home directory for both HPCs, hence I will have an identical bash env - via <a href=../../cpu/sumner_3/#bash-startup>bash startup sequence</a> - in Winter as of Sumner.</p> <details class=info><summary>home directory and operating system</summary><p>If you have a separate OS and a home directory for CPU and GPU HPCs, you need to start from a scratch in setting up GPU HPC, i.e., initial setup is identical to <a href=../../cpu/sumner_1/ >CPU setup</a>, preferably all three parts or at least installing <em>yoda</em> env and bash startup sequence.</p> <p>If you have an identical home directory but different OS, e.g., Cent OS 6 on CPU HPC and Cent OS 7 on GPU HPC, that's a bad system design in my view as it will be challenging - at least to me - to separate software compilation libraries by modifying PATH, LD_LIBRARY_PATH, etc. and configuration locations, e.g., ~/.local and ~/.config under the shared bash env.</p> </details> <ul> <li>Login to Winter HPC</li> </ul> <div class=highlight><pre><span></span><code>ssh winter
</code></pre></div> <blockquote> <p>If you have set <a href=../../cpu/sumner_3/#bash-startup>bash startup sequence</a> earlier, you should expect ~identical<sup id=fnref:diff_bash_env><a class=footnote-ref href=#fn:diff_bash_env>1</a></sup> bash env, including ordering of paths (output of <code>echo $PATH</code>) between CPU and GPU HPCs.</p> </blockquote> <ul> <li>Start an interactive job, so that we can use compute and not login node for setup/ This is to avoid our setup being potentially killed on the login node due to compute and/or memory intensive commands we will run during setup.</li> </ul> <div class=highlight><pre><span></span><code><span class=c1>## interactive job command may vary across HPCs</span>
<span class=c1>## requesting partition: gpu with one gpu core</span>
srun --job-name<span class=o>=</span>gpusetup --qos<span class=o>=</span>dev --time<span class=o>=</span><span class=m>08</span>:00:00 --mem<span class=o>=</span>8G --nodes<span class=o>=</span><span class=m>1</span> --ntasks<span class=o>=</span><span class=m>2</span> --mail-type<span class=o>=</span>FAIL --export<span class=o>=</span>all --gres gpu:1 --pty bash --login
</code></pre></div> <blockquote> <p>Notice that I now use <code>bash --login</code> over <code>bash</code> to force interactive login. Details under <a href=../../cpu/sumner_3/#bash-startup>bash startup sequence</a>.</p> </blockquote> <p>Once you are in the interactive session, bash prompt will change to <em>user@winter200</em> or some other number than the original login node. We are going to create a new and dedicated conda env for GPU HPC, named <em>rey</em>. That said, we can use previously setup conda env for CPU HPC here too!</p> <ul> <li>For example, to start R session on GPU HPC:</li> </ul> <div class=highlight><pre><span></span><code>mamba activate yoda
R
</code></pre></div> <p>You should be able to interact with R same as you do on CPU HPC, as long as both HPCs have shared storage paths and an identical OS.</p> <div class="admonition warning"> <p class=admonition-title>Avoid managing conda env across HPCs</p> <p>While it should not matter if you are managing conda env on CPU or GPU HPC, e.g., installing or upgrading conda packages, I prefer to manage all of <a href=../../cpu/sumner_2/#create-a-new-env>CPU optimized conda envs</a>, i.e., <em>base</em>, <em>yoda</em>, <em>leia</em>, etc. from Sumner (CPU) HPC. Accordingly, I will use Winter GPU HPC to manage GPU-optimized conda env, i.e., <em>rey</em> and <em>ben</em>. This is particularly important for managing GPU env as CUDA and other GPU-specific libraries are not available on CPU HPC and so, installing or upgrading GPU packages may fail if you use CPU HPC to manage GPU env.</p> </div> <p>Let's deactivate <em>yoda</em> and return to <em>base</em> env in the Winter HPC.</p> <div class=highlight><pre><span></span><code>mamba deactivate
</code></pre></div> <h2 id=create-a-gpu-env-rey>Create a GPU env <em>rey</em><a class=headerlink href=#create-a-gpu-env-rey title="Permanent link">&para;</a></h2> <p>Now, we are going to install <em>sizable</em> (3 GB or more) worth of packages into a new conda env, <em>rey</em>. These packages form core of deep learning or specifically provide set of algorithms to employ artificial neural network based machine learning.</p> <div class=highlight><pre><span></span><code>mamba create -c conda-forge -c pytorch -n rey <span class=nv>python</span><span class=o>=</span><span class=m>3</span>.9 tensorflow-gpu keras pytorch torchvision torchaudio <span class=nv>cudatoolkit</span><span class=o>=</span><span class=m>11</span>.1.1 cudatoolkit-dev<span class=o>=</span><span class=m>11</span>.1.1 scikit-learn xgboost r-base<span class=o>=</span><span class=m>4</span>.1.1 r-tensorflow r-keras r-tfdatasets tensorflow-hub cupy dask dask-ml pyopencl pocl 

<span class=c1>## lazy way to check if above command had any errors.</span>
<span class=c1>## should return 0, meaning successful execution of</span>
<span class=c1>## the most recent previous command.</span>
<span class=nb>echo</span> <span class=nv>$?</span>
</code></pre></div> <p><mark>Before running above command, please know what we are installing here:</mark></p> <ul> <li>Create a new conda env, <em>rey</em> for GPU-based HPC.</li> <li>Install all packages with the highest preference from <em>conda-forge</em> channel followed by <em>pytorch</em>. <a href=https://pytorch.org>PyTorch</a> is a a commonly used deep learning library and PyTorch team distributes some of dependencies with their own conda channel.</li> <li>For all practical purposes, we will try to keep <em>rey</em> env similar to <em>yoda</em> env while adding GPU support in <em>rey</em>. Accordingly, we need to ensure that we are using similar <code>major.minor</code> version for Python and R - two major programming languages that I use on daily basis.<ul> <li>I am using python 3.10 in <em>yoda</em>. However, python 3.10 support is <a href="https://github.com/pytorch/pytorch/issues/66424 for PyTorch">not yet available</a>, a commonly used deep learning library. Hence, I am specifying <code>python=3.9</code> to ensure that <code>mamba create</code> will do the best to keep that version. You may try using the same python version as you have in <em>yoda</em> env, and check if <code>mamba create ...</code> command above throws an error regarding conflicting versions. If it does, update <code>=3.XX</code> to a one lower minor version until mamba allows you to create a new env, <em>rey</em>.</li> <li>Same logic for R by using <code>r-base=4.1.1</code> to match R version in <em>yoda</em> env. Please read <strong>important notes below</strong> on using R packages across two or more conda envs.</li> </ul> </li> <li>Install popular ML frameworks with GPU support: <a href=https://www.tensorflow.org/install/gpu>Tensorflow 2</a>, <a href=https://keras.io/getting_started>Keras</a>, and <a href=https://pytorch.org/get-started/locally>PyTorch</a>. Keras now ships with Tensorflow 2 and so specifying keras in command above is optional.<ul> <li>Notice that unlike restricting version for Python and R (to match with that in <em>yoda</em> env), we are not specifying versions for any of ML libraries. Doing so has one drawback that in rare cases, conda may end up installing an older but compatible version (with our Python and R) of one or more ML libraries. If this happens and you are in need of the latest ML library, you have an option to create yet another conda env to install the most recent ML library at the cost of possibly installing a different version of Python and R than one in <em>yoda</em> env.</li> </ul> </li> <li> <p>CUDA toolkit is the heart of leveraging GPU support on Winter HPC. Using conda, we are installing CUDA toolkit and related development kit to install NVIDIA&reg; <a href=https://developer.nvidia.com/cudnn>cuDNN library</a>. However, we will <strong>ensure - by appending, <code>=11.1.1</code> to a package - that CUDA toolkit version must match that of system installed CUDA drivers by HPC staff</strong>. If there is a mismatch, GPU hardware (NVIDIA V100 card) may fail to recognize our instructions (commands) to perform machine learning analysis.</p> <ul> <li>For Winter HPC at JAX, I am using <mark>CUDA 11.1.1</mark> based on available drivers in Winter HPC. These drivers are typically configured using HPC modules and you can list those using <code>module available</code> and then list details for a specific drivers, e.g, <code>module show cuda11.1/toolkit/11.1.1</code>. Besides toolkit, HPC staff also provides following other core drivers which may be required for installing or running a specific GPU-compiled package. For now, I am not loading any of these default modules and instead relying on conda-managed (and minimal) packages.</li> </ul> <div class=highlight><pre><span></span><code>cuda11.1/blas/11.1.1
cuda11.1/fft/11.1.1
cuda11.1/nsight/11.1.1
cuda11.1/profiler/11.1.1
cuda11.1/toolkit/11.1.1 
</code></pre></div> </li> <li> <p>We will also install <a href=https://scikit-learn.org>scikit-learn</a> and <a href=https://xgboost.readthedocs.io/en/stable/ >XGBoost</a>, two popular libraries for machine learning at-large. </p> </li> <li>Then, I will install GPU support for R language and a few packages for using <a href=https://tensorflow.rstudio.com/tutorials/ >Tensorflow for R</a>.<ul> <li>We have earlier <a href=../../cpu/sumner_2/#installing-r>installed R</a> in <em>yoda</em> but we cannot use it in <em>rey</em> env. To leverage R for machine (and deep) learning, I will install the identical R version, i.e. 4.1.1 in conda env, <em>rey</em>. That way, I can use most of R packages from <em>yoda</em> (CPU-based) env for use in <em>rey</em> (GPU-based) env.</li> </ul> </li> </ul> <div class="admonition warning"> <p class=admonition-title>Careful sharing R packages across two or more conda envs</p> <p>Do note that some R packages requires additional packages (libraries) to be installed in the respective conda env, e.g., rJava requires <code>java</code> from <em>yoda</em> env and may not work with <em>rey</em> env. In such cases, use <code>mamba install</code> to install such packages in <em>rey</em> while on GPU env but <em>avoid</em> running <code>install.packages</code> command from a R session running in <em>rey</em> env. Why?</p> <p>I have briefly touched on this issue in <a href=../../cpu/sumner_3/#tips-on-compiling-packages>Part 3: Tips on compiling packages</a>. If we use <code>install.packages</code> from <em>rey</em> env, it will end up installing the same package, e.g., <code>rJava</code> and perhaps, all of its dependencies into the same library path as of <em>yoda</em> env, i.e., as defined by first entry of <code>.libPaths()</code>. That is a recipe for warnings and errors because doing so will inevitably mix up library dependencies between two different conda envs, each optimized for CPU and GPU.</p> <p>There is a solution though! We can update <code>.libPaths()</code> for <em>rey</em> on-the-fly when we activate or deactivate <em>rey</em> env (<a href=#renviron-setup>explained later</a>) and that way, we can ensure that <code>install.packages</code> <em>should</em> install packages in <em>rey</em> specific R package path. I say "should" as R may end up updating packages in any of user-writable paths, even if the path is set as a second or lower preference.</p> <p>In nutshell, to avoid breaking R in multiple conda env, use <code>mamba install</code> or <code>mamba update</code> over R <code>install.packages()</code> when possible.</p> </div> <ul> <li>I will also install a few additional packages for image classification and related machine learning purpose. These are: <a href=https://cupy.dev>cupy</a>, <a href=https://docs.dask.org>dask</a>, <a href=https://ml.dask.org>dask-ml</a>, <a href=https://documen.tician.de/pyopencl>pyopencl, and pocl</a>. A notable exception is that I am not installing <a href=https://github.com/Theano/Theano>Theano</a> which is not under active development but now forked as <a href=https://github.com/aesara-devs/aesara>Aesara</a>.</li> <li>I am installing all major packages at once to ensure package dependencies are not in conflict and we have a stable GPU env.</li> <li>While some of packages, e.g., r-tensorflow may work on CPU-based HPC too, I would recommend to use this conda env only on the GPU-based HPC as most of packages require GPU support.</li> </ul> <h2 id=test-gpu-functionality>Test GPU functionality<a class=headerlink href=#test-gpu-functionality title="Permanent link">&para;</a></h2> <p>Once we have <em>rey</em> env ready, we can test GPU functionality of installed packages. This is not a required step but I like to make sure that I am using GPU and not CPU for computation, e.g., tensorflow and r-keras package may fall back to CPU if it finds missing or badly configured support for GPU.</p> <ul> <li>Let's activate <em>rey</em> and power up GPU!</li> </ul> <div class=highlight><pre><span></span><code>mamba activate rey
</code></pre></div> <ul> <li>Check NVIDIA driver version</li> </ul> <div class=highlight><pre><span></span><code>nvcc --version
</code></pre></div> <div class=highlight><pre><span></span><code>nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2020 NVIDIA Corporation
Built on Mon_Oct_12_20:09:46_PDT_2020
Cuda compilation tools, release 11.1, V11.1.105
Build cuda_11.1.TC455_06.29190527_0
</code></pre></div> <ul> <li>Check GPU usage activity on the compute node using <code>nvidia-smi</code>. This command is from a system-installed cuda libraries, typically under <code>/usr/bin</code> or <code>/usr/local/bin</code>. On Winter HPC at JAX, it is only available on compute nodes and not on a login node.</li> </ul> <h2 id=jupyter-kernels>Jupyter kernels<a class=headerlink href=#jupyter-kernels title="Permanent link">&para;</a></h2> <p>Let's install Python and R jupyter kernels for <em>rey</em> with <a href=../../cpu/sumner_2/#python-kernel>configuration</a> similar to that for <em>yoda</em> env.</p> <ul> <li>First, we will install required packages. Here, I am not interested in installing bash_kernel as I did with <em>yoda</em> as I rarely use bash kernel and rather prefer terminal. If installing reticulate and rpy2 packages throw warnings about potential upgrade or downgrade of existing packages in <em>rey</em> env, please <strong>do not ignore warnings</strong> and instead <a href=../../cpu/sumner_2/#reticulate-r-package>follow steps under installing respective packages in <em>yoda</em> env</a>.</li> </ul> <div class=highlight><pre><span></span><code>mamba install -c conda-forge ipykernel r-irkernel r-reticulate rpy2
</code></pre></div> <ul> <li>Setup Python jupyter kernel for <em>rey</em></li> </ul> <div class=highlight><pre><span></span><code>python -m ipykernel install --user --name rey_py39 --display-name <span class=s2>&quot;rey_py39&quot;</span>

<span class=c1>## confirm that installation exited without any error</span>
<span class=c1>## this should return 0 for successful installation</span>
<span class=nb>echo</span> <span class=nv>$?</span>
</code></pre></div> <ul> <li>Setup R jupyter kernel for <em>rey</em></li> </ul> <div class=highlight><pre><span></span><code><span class=nf>library</span><span class=p>(</span><span class=n>IRkernel</span><span class=p>)</span>
<span class=nf>installspec</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;rey_r41&quot;</span><span class=p>,</span> <span class=n>displayname</span> <span class=o>=</span> <span class=s>&quot;rey_r41&quot;</span><span class=p>,</span> <span class=n>user</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>

<span class=c1>## quit R session</span>
<span class=nf>q</span><span class=p>(</span><span class=n>save</span> <span class=o>=</span> <span class=s>&quot;no&quot;</span><span class=p>)</span>
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>Configure Python and R kernel loading for <em>rey</em></p> <p>Don't forget to <a href=../../cpu/sumner_2/#kernel-loading>tweak kernel loading</a> as we did for <em>yoda</em> env else you may encounter issues running GPU-based packages in JupyterLab env.</p> <p>Pro Tip: You can use conditional expression in kernel wrapper, so kernel can only load on GPU-enabled HPC.</p> <div class=highlight><pre><span></span><code><span class=k>if</span> <span class=o>[[</span> <span class=s2>&quot;</span><span class=k>$(</span>hostname<span class=k>)</span><span class=s2>&quot;</span> !<span class=o>=</span> *<span class=s2>&quot;winter&quot;</span>* <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
    <span class=nb>echo</span> -e <span class=s2>&quot;ERROR: Invalid hostname\nThis kernel works only on winter HPC\n&quot;</span> &gt;<span class=p>&amp;</span><span class=m>2</span>
    <span class=nb>exit</span> <span class=m>1</span>
<span class=k>else</span>
    <span class=c1>#### Activate CONDA in subshell ####</span>
    <span class=c1>## Read https://github.com/conda/conda/issues/7980</span>
    <span class=nv>CONDA_BASE</span><span class=o>=</span><span class=k>$(</span>conda info --base<span class=k>)</span> <span class=o>&amp;&amp;</span> <span class=se>\</span>
    <span class=nb>source</span> <span class=s2>&quot;</span><span class=si>${</span><span class=nv>CONDA_BASE</span><span class=si>}</span><span class=s2>&quot;</span>/etc/profile.d/conda.sh <span class=o>&amp;&amp;</span> <span class=se>\</span>
    conda activate rey
    <span class=c1>#### END CONDA SETUP ####</span>

    <span class=c1>## Load additional CUDA drivers, toolkit, etc.</span>
    <span class=c1>## if applicable prior to initializing kernel</span>
    <span class=c1># module load cuda11.1/toolkit/11.1.1</span>

    <span class=c1>##... rest of kernel setup as explained earlier.</span>
</code></pre></div> </div> <h3 id=renviron-setup>Renviron setup<a class=headerlink href=#renviron-setup title="Permanent link">&para;</a></h3> <p>As explained above in the warning box, be careful installing packages using R from more than one conda envs and instead prefer using <code>mamba install</code> or <code>mamba update</code> to manage R packages. </p> <p>When we start R, it reads <em>~/.Renviron</em> file or takes precedence based on order as detailed on <a href=https://cran.r-project.org/web/packages/startup/vignettes/startup-intro.html>CRAN - startup</a> webpage. Accordingly, we will create a <em>rey</em> env-specific R Renviron file such that loading R in <em>rey</em> env will use rey specific library path to install new packages<sup id=fnref:warnrpkg><a class=footnote-ref href=#fn:warnrpkg>2</a></sup>, and will not install those under a default library path for <em>yoda</em> that we specified <a href=../../cpu/sumner_2/#setup-rprofile-and-renviron>earlier in the setup</a>.</p> <ul> <li>Let's create an empty directory to store <em>rey</em> env specific user R packages.</li> </ul> <div class=highlight><pre><span></span><code>mkdir -p /projects/verhaak-lab/amins/hpcenv/opt/R/pkgs/rey4.1
</code></pre></div> <ul> <li>Create an env specific config directory at the place you like and create a Renviron file inside it.</li> </ul> <div class=highlight><pre><span></span><code>mkdir -p /projects/verhaak-lab/amins/hpcenv/opt/R/confs/rey
<span class=nb>cd</span> /projects/verhaak-lab/amins/hpcenv/opt/R/confs/rey

<span class=c1>## create a Renviron file</span>
nano Renviron
</code></pre></div> <ul> <li>Add following to Renviron file, i.e., we take the <code>R_LIBS</code> path from <em>~/.Renviron</em> file we <a href=../../cpu/sumner_2/#setup-rprofile-and-renviron>created earlier</a>, and then <strong>prefix</strong> <em>rey</em> env specific paths to it. Here, <em>rey</em> env path consist of two parts:<ul> <li>First, <em>/projects/verhaak-lab/amins/hpcenv/opt/R/pkgs/rey4.1</em> is a newly created custom path where <code>install.packages</code> command can install new packages while working in <em>rey</em> but not <em>yoda</em> env.</li> <li>Second, <em>rey</em> env default R library path that we got from <code>.libPaths()</code> output: <em>/projects/verhaak-lab/amins/hpcenv/mambaforge/envs/rey/lib/R/library</em>. This path is used by <code>mamba install</code> or <code>mamba update</code> for managing R packages.</li> </ul> </li> </ul> <div class=highlight><pre><span></span><code><span class=n>R_LIBS</span><span class=o>=</span><span class=s>&quot;</span><span class=err>/projects/verhaak-lab/amins/hpcenv/opt/R/pkgs/rey4.1:/projects/verhaak-lab/amins/hpcenv/mambaforge/envs/rey/lib/R/library:/projects/verhaak-lab/amins/hpcenv/opt/R/pkgs/4.1:/projects/verhaak-lab/amins/hpcenv/mambaforge/envs/yoda/lib/R/library</span>
</code></pre></div> <ul> <li>Now setup a custom loading of Renviron for <em>rey</em> env. This will make sure that R environ will switch/revert every time conda env, <em>rey</em> is loaded/unloaded via <code>mamba activate/deactivate</code> command.</li> </ul> <div class=highlight><pre><span></span><code><span class=nb>cd</span> /projects/verhaak-lab/amins/hpcenv/mambaforge/envs/rey/etc/conda

<span class=c1>## create a new file</span>
nano activate.d/activate-r-env.sh
</code></pre></div> <ul> <li>Add following to <em>activate.d/activate-r-env.sh</em></li> </ul> <div class=highlight><pre><span></span><code><span class=ch>#!/usr/bin/env sh</span>

<span class=c1>## Define R_HOME from rey env</span>
<span class=nv>R_HOME</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$CONDA_PREFIX</span><span class=s2>/lib/R&quot;</span>
<span class=c1>## override ~/.Renviron which otherwise point to R from yoda env</span>
<span class=nv>R_ENVIRON_USER</span><span class=o>=</span><span class=s2>&quot;/projects/verhaak-lab/amins/hpcenv/opt/R/confs/rey/Renviron&quot;</span>

<span class=nb>export</span> R_HOME R_ENVIRON_USER
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>load custom user setup after default setup</p> <p><a href=../../cpu/sumner_3/#bash-startup>bash startup</a> reads file in alphanumeric order. There could be other R setup files, e.g., <em>activate.d/activate-r-base.sh</em>. So, make sure to name custom file(s), e.g., <em>activate-r-env.sh</em> file such that it loads after R specific default files. </p> </div> <ul> <li>Similarly create a <em>deactivate.d/deactivate-r-env.sh</em> to unload custom changes when we do <code>mamba deactivate</code> to turn off <em>rey</em> env.</li> </ul> <div class=highlight><pre><span></span><code>nano deactivate.d/deactivate-r-env.sh
</code></pre></div> <ul> <li>and add following:</li> </ul> <div class=highlight><pre><span></span><code><span class=ch>#!/usr/bin/env sh</span>

<span class=c1>## fall back to pre-existing R env</span>
<span class=nb>unset</span> R_HOME R_ENVIRON_USER
</code></pre></div> <div class="admonition info"> <p class=admonition-title>Prefer <code>mamba deactivate</code> followed by <code>mamba activate &lt;env name&gt;</code></p> <p><code>unset</code> command will erase and not restore the matching custom env variables, if any. So, ideally you should do <code>mamba deactivate</code> to turn off <em>rey</em> and then do <code>mamba activate yoda</code> to properly activate <em>yoda</em> env to restore custom set env variables and all of env specific bash startup under respective <em>activate.d/</em> directory. </p> </div> <ul> <li>Now logout and login to winter HPC again. Do <code>mamba activate rey</code> and start R, and type <code>.libPaths()</code>. Now, exit R and type do <code>mamba deactivate</code> followed by <code>mamba activate yoda</code>. Start R and type <code>.libPaths()</code>. Notice difference in R library paths under two R sessions!</li> </ul> <h2 id=optional-setup>Optional Setup<a class=headerlink href=#optional-setup title="Permanent link">&para;</a></h2> <p>Following packages are optional for setup.</p> <h3 id=tensorboard>Tensorboard<a class=headerlink href=#tensorboard title="Permanent link">&para;</a></h3> <p><a href=https://www.tensorflow.org/tensorboard>Tensorboard</a> graphical user interface (GUI) ships with Tensorflow 2 and so does not require additional configuration.</p> <ul> <li>Check version for tensorflow and tensorboard</li> </ul> <div class=highlight><pre><span></span><code><span class=c1>## in rey env</span>
python -c <span class=s1>&#39;import tensorflow as tf; print(tf.__version__)&#39;</span> <span class=c1>#2.6.2 or higher</span>
python -c <span class=s1>&#39;import tensorboard as tb; print(tb.__version__)&#39;</span> <span class=c1>#2.6.0 or higher</span>
</code></pre></div> <ul> <li>Checkout <a href=https://www.tensorflow.org/tensorboard/get_started>getting started guide</a> for more on how to use GUI app. If tensorboard python notebook extension, <code>%load_ext tensorboard</code> fails to initialize tensorboard within notebook, you can manually initialize tensorboard using a terminal command as follows: </li> </ul> <div class=highlight><pre><span></span><code>tensorboard serve --logdir logs --host &lt;IP address to <span class=nb>bind</span> to&gt;
</code></pre></div> <blockquote> <p>where IP address can be a localhost or <code>hostname -I</code> as long as it is on the secure network. Tensorboard should be accessible at an unsecure http address shown in the output of above command.</p> </blockquote> <ul> <li>To quit tensorboard web server on the terminal, press <span class=keys><kbd class=key-control>Ctrl</kbd><span>+</span><kbd class=key-c>C</kbd></span>.</li> </ul> <h3 id=tensorrt>TensorRT<a class=headerlink href=#tensorrt title="Permanent link">&para;</a></h3> <p><a href=https://developer.nvidia.com/tensorrt>NVIDIA&reg; TensorRT&trade;</a> a software development kit (SDK) for NVIDIA compliant GPU cards. Conda does not provide TensorRT package, so we need to install it using <a href=https://developer.nvidia.com/tensorrt-getting-started>getting started guide</a> and <a href=https://docs.nvidia.com/deeplearning/tensorrt/install-guide/index.html#installing-tar>installation using tarball</a> instructions. This requires membership into NVIDIA developer program.</p> <ul> <li>Download tarball specific to CUDA and cuDNN version as determined by following commands. Accordingly, I have downloaded </li> </ul> <p>TensorRT-8.2.2.1.Linux.x86_64-gnu.cuda-11.4.cudnn8.2.tar.gz TensorRT-6.0.1.5.CentOS-7.6.x86_64-gnu.cuda-10.1.cudnn7.6.tar.gz.</p> <div class=highlight><pre><span></span><code><span class=c1>## CUDA version, 11.1</span>
nvcc --version
<span class=c1>## cuDNN version 8.2</span>
cat <span class=si>${</span><span class=nv>CONDA_PREFIX</span><span class=si>}</span>/include/cudnn_version.h <span class=p>|</span> grep CUDNN_MAJOR -A <span class=m>2</span>
</code></pre></div> <ul> <li></li> </ul> <h3 id=image-classification>Image Classification<a class=headerlink href=#image-classification title="Permanent link">&para;</a></h3> <p>Libraries specific to cell segmentation</p> <h4 id=cellprofiler>Cellprofiler<a class=headerlink href=#cellprofiler title="Permanent link">&para;</a></h4> <h4 id=cellpose>Cellpose<a class=headerlink href=#cellpose title="Permanent link">&para;</a></h4> <h4 id=stardist>Stardist<a class=headerlink href=#stardist title="Permanent link">&para;</a></h4> <h2 id=update-bash-startup>Update bash startup<a class=headerlink href=#update-bash-startup title="Permanent link">&para;</a></h2> <p>Finally, I am tweaking <a href=../../cpu/sumner_3/#bash-startup>bash startup sequence</a> that we setup earlier, such that it can allow loading GPU-specific bash env only when we login to Winter GPU HPC and not on Sumner CPU HPC. I have made following changes to bash startup. You can <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path fill-rule=evenodd d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0v-2.5zm7.5-.188V4.25c0 .138.112.25.25.25h2.688a.252.252 0 0 0-.011-.013l-2.914-2.914a.272.272 0 0 0-.013-.011zM5.72 6.72a.75.75 0 0 0 0 1.06l1.47 1.47-1.47 1.47a.75.75 0 1 0 1.06 1.06l2-2a.75.75 0 0 0 0-1.06l-2-2a.75.75 0 0 0-1.06 0zM3.28 7.78a.75.75 0 0 0-1.06-1.06l-2 2a.75.75 0 0 0 0 1.06l2 2a.75.75 0 0 0 1.06-1.06L1.81 9.25l1.47-1.47z"/></svg></span> <a href=https://github.com/sbamin/code101/tree/main/confs/hpc/user_env/ >download my bash startup files here</a>.</p> <ul> <li>Update <code>SET PATH</code> block of <em>~/.bash_profile</em> to reset PATH for Winter GPU. See my notes under <code>elif [[ "$(hostname)" == *"winter"* ]]; then</code> section in <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path fill-rule=evenodd d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0v-2.5zm7.5-.188V4.25c0 .138.112.25.25.25h2.688a.252.252 0 0 0-.011-.013l-2.914-2.914a.272.272 0 0 0-.013-.011zM5.72 6.72a.75.75 0 0 0 0 1.06l1.47 1.47-1.47 1.47a.75.75 0 1 0 1.06 1.06l2-2a.75.75 0 0 0 0-1.06l-2-2a.75.75 0 0 0-1.06 0zM3.28 7.78a.75.75 0 0 0-1.06-1.06l-2 2a.75.75 0 0 0 0 1.06l2 2a.75.75 0 0 0 1.06-1.06L1.81 9.25l1.47-1.47z"/></svg></span> an example <a href=https://github.com/sbamin/code101/blob/main/confs/hpc/user_env/.bash_profile>.bash_profile</a> file.</li> <li>Update <em>~/.profile.d/void/VW01_set_winter_gpu.sh</em> to load Winter specific settings. See more into an example <a href=https://github.com/sbamin/code101/blob/main/confs/hpc/user_env/.profile.d/void/VW01_set_winter_gpu.sh>VW01_set_winter_gpu.sh</a> file.</li> </ul> <p>Logout and login again to Winter HPC. You will see a near identical bash prompt like Sumner HPC, e.g., <code>user@winter-log1</code>. However, when you check <code>echo $PATH</code> output and <code>echo $CONDA_DEFAULT_ENV</code>, you will notice that a default conda env in Winter HPC is now <em>rey</em> while in Sumner HPC, it is <em>base</em> (sometimes called <em>root</em>). Of course, you can revert to base or any other conda env in Winter HPC by doing <code>mamba deactivate</code> (because we changed from base to rey during bash startup) and then <code>mamba activate base</code> (or yoda, or any other env).</p> <h2 id=done>Done!<a class=headerlink href=#done title="Permanent link">&para;</a></h2> <p>Hope you have found this documentation helpful to get you started with HPC setup. I will post a few external resources on getting started guide to learn programming in Python, R, and more. Best wishes!</p> <div class=footnote> <hr> <ol> <li id=fn:diff_bash_env> <p>There could be a difference though if both HPCs do not share common OS or they are using different system defaults, e.g., loading different bash env from <code>/etc/profile</code> which is managed by HPC staff.&#160;<a class=footnote-backref href=#fnref:diff_bash_env title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> <li id=fn:warnrpkg> <p>See <a href=#create-a-gpu-env-rey>warning box above</a> on why our setup can still update R packages managed by <em>yoda</em> env despite using custom Renviron file.&#160;<a class=footnote-backref href=#fnref:warnrpkg title="Jump back to footnote 2 in the text">&#8617;</a></p> </li> </ol> </div> <!-- Source file information --> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2022-01-09</span> </small> </div> <!-- end default contents --> <!-- Get setting from mkdocs.yml, but allow page-level overrides --> <!-- Inject Disqus into current page --> <p><small>Author: <a href=https://sbamin.com/about rel=me>Samir B. Amin</a> <span class=twemoji> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </span><a href=https://twitter.com/sbamin>@sbamin</a></small></p> <!--   <script src="https://code.sbamin.com/../../../assets/javascripts/bundle.93302429.min.js"></script>
  <script src="https://code.sbamin.com/../../../assets/javascripts/bundle.71c96ae2.min.js"></script> --> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <!-- Footer --> <footer class=md-footer> <!-- Link to previous and/or next page --> <nav class="md-footer__inner md-grid" aria-label=Footer> <!-- Link to previous page --> <a href=../../cpu/sumner_3/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Part 3" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Part 3 </div> </div> </a> <!-- Link to next page --> </nav> <!-- Further information --> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <!-- Copyright and theme information --> <div class=md-copyright> <div class=md-copyright__highlight> &copy; 2003-2022: <a href=https://sbamin.com title=Home>SBAmin.com</a> | <a href=/disclosure/ >Disclosure</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <!-- Social links --> <div class=md-social> <a href=https://sbamin.com/about target=_blank rel=noopener title=sbamin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path fill-rule=evenodd d="M10.5 5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0zm.061 3.073a4 4 0 1 0-5.123 0 6.004 6.004 0 0 0-3.431 5.142.75.75 0 0 0 1.498.07 4.5 4.5 0 0 1 8.99 0 .75.75 0 1 0 1.498-.07 6.005 6.005 0 0 0-3.432-5.142z"/></svg> </a> <a href=https://twitter.com/sbamin target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://linkedin.com/in/samiramin/ target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://github.com/sbamin target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://sbamin.com/contact target=_blank rel=noopener title=sbamin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.instant", "navigation.top", "navigation.indexes", "navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.b6ff8c07.min.js", "version": {"provider": "mike", "default": "latest"}}</script> <script src=../../../assets/javascripts/bundle.5e13d264.min.js></script> <script src=../../../assets/js/extra.js></script> <script src=../../../assets/js/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js></script> <script src=../../../assets/js/tables.js></script> </body> </html>